# 组合数学

## 容斥原理与子集卷积

### Zeta变换与Moebius变换

定义1：

$$(\zeta f)(S)=\sum_{T \subseteq S}{f(T)}$$

$$(\mu f)(S)=\sum_{T \subseteq S}{(-1)^{|S|-|T|}f(T)}$$

定理1：

$$(\mu \zeta f)(S) = (\zeta \mu f)(S)=f(S)$$

也可写作：

$$ g(S)=\sum_{T\subseteq S}{f(T)}\Rightarrow f(S)=\sum_{T\subseteq S}{(-1)^{|S|-|T|}g(T)}$$

证明1：

$$
(\mu \zeta f)(S)
=\sum_{T \subseteq S}{(\zeta f)(T)}
=\sum_{T\subseteq S}{(-1)^{|S|-|T|}\sum_{U\subseteq T}{f(U)}}
$$
$$
=\sum_{U\subseteq S}{f(U)\sum_{U\subseteq T \subseteq S}{(-1)^{|S|-|T|}}}
=\sum_{U\subseteq S}{f(U)\sum_{V\subseteq S-U}{(-1)^{|V|}}}
$$
$$
=\sum_{U\subseteq S}{f(U)[|S]-|U|=0]}
=f(S)
$$

注：同时有

$$ 
    g(S)=\sum_{T \supseteq S}{f(T)}\Rightarrow f(S)=\sum_{T\supseteq S}{(-1)^{|T|-|S|}g(T)}
$$

定义2：容斥原理背景

设有许多性质$P_i$,性质的全集为$U$, $A_i=\{x|P_i(x)\}$表示满足第$i$个性质的集合

对于一些性质的集合$S$,定义

$$f(S)=\{x|\exist i \in S,P_i(x)\}=\left|\bigcup_{i\in S}{A_i}\right|$$

$$g(S)=\{x|\forall i \in S, P_i(x)\}=\left|\bigcap_{i\in S}{A_i}\right|$$

$$ h(S)=\{x|(\forall i \in S, P_i(x))\wedge(\forall i \notin S, \neg P_i(x)\} 
=\left|\bigcap_{i\in S}{A_i}-\bigcup_{i\notin S}{A_i}\right|
$$

则由定义有：

$$ f(U)=\sum_{\emptyset \neq S\subseteq U}{h(S)}$$

$$ g(T)=\sum_{S \supseteq T}{h(S)}$$

定理2：容斥原理

$$ f(U)=\sum_{\emptyset \neq T \subseteq U} {(-1)^{|T|+1}g(T)}$$

证明2：

$$
f(U)=\sum_{\emptyset \neq S \subseteq U}{h(S)}
=\sum_{\emptyset \neq S \subseteq U}{\sum_{T\supseteq S}{(-1)^{|T|-|S|}g(T)}}
=\sum_{\emptyset \neq T \subseteq U}{(-1)^{|T|}g(T)\sum_{\emptyset \neq S\subseteq T}{(-1)^{|S|}}}
$$
$$
=\sum_{\emptyset \neq T \subseteq U}{(-1)^{|T|}g(T)}(\sum_{S\subseteq T}{(-1)^{|S|}-(-1)^{|\emptyset |})}
=\sum_{\emptyset \neq T \subseteq U}{(-1)^{|T|+1}g(T)}
$$

## 生成函数

### 一般生成函数

定义：一个序列$\{a_i\}$的生成函数为$$F(x)=\sum_{i=0}^{\infty}{a_ix^i}$$

易得两个生成函数的乘积即为对应序列的卷积：

$$H(x)=F(x)G(x)=\sum_{i=0}^{\infty}{c_ix^i}=\sum_{i=0}^\infty{\left(\sum_{j=0}^{i}{a_jb_{i-j}}\right)x^i}$$

即

$$c_i=\sum_{j=0}^{i}{a_jb_{i-j}}$$

注：一般生成函数的系数可看作某种组合方案，两个一般生成函数的卷积的第$i$项系数的意义（即上式）可看作对从第一个集合中选$j$个，第二个集合中选$i-j$个的组合的方案数求和。

### 指数生成函数

定义：一个序列$\{a_i\}$的指数生成函数(EGF)为$$F(x)=\sum_{i=0}^{\infty}{a_i\frac{x^i}{i!}}$$

易得两个指数生成函数的乘积即为对应序列的带二项式系数的卷积：

$$H(x)=F(x)G(x)=\sum_{i=0}^{\infty}{c_i\frac{x^i}{i!}}
$$
$$
=\sum_{i=0}^\infty{\left(\sum_{j=0}^{i}{i!\frac{a_j}{j!}\frac{b_{i-j}}{(i-j)!}}\right)\frac{x^i}{i!}}=\sum_{i=0}^\infty{\left(\sum_{j=0}^i{\binom{i}{j}a_jb_{i-j}}\right)\frac{x^i}{i!}}
$$

即

$$c_i=\sum_{j=0}^{i}{\binom{i}{j}a_jb_{i-j}}$$

注：指数生成函数的系数可看作某种排列方案，两个指数生成函数的卷积的第$i$项系数的意义（即上式）可看作对从第一个集合中选$j$个，第二个集合中选$i-j$个，并将i个位只中的j个钦定为从第一个集合中选出来的，余下$i-j$个钦定为从第二个集合中选出来的的所有排列的方案数求和。（因此有个组合数作为系数）


### 常见计数序列的生成函数

$$a_i=1:F(x)=\frac{1}{1-x}$$

$$a_i=Fibonacci_i: F(x)=1+xF(x)+x^2F(x)\Rightarrow F(x)=\frac{1}{1-x-x^2}$$

$$a_i=Catalan_i: F(x)=1+xF(x)^2 \Rightarrow F(x)=\frac{1-\sqrt{1-4x}}{2x}$$

## 图计数

### 有标号有根树计数

### 无标号有根树计数

### 有标号无根树计数

### 无标号无根树计数

### 有标号基环树计数

### 有标号连通图计数

### 有标号双连通图计数

### 有标号二分图计数

### 有标号DAG计数

### 有标号强连通图计数

