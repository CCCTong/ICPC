### Yukikaze and Demons

题意：给出一棵树，每个顶点有一个十进制数位，定义一条简单路径$(u,v)$的权值为将从$u$到$v$的路径上的所有顶点上的数位连起来所组成的十进制数。统计有多少条路径的权值能被给定的数$k$整除。

分治统计答案。

设当前分治块中心为$r$，需要统计经过$r$的满足条件的路径数量。

将每条经过$r$的路径$(u,v)$分成两段，第一段为$(u,r)$，第二段为(r,v)去掉$r$，做法为枚举第二段并统计拼上第二段后满足条件的第一段路径有多少条。

不妨设当前枚举的第二段权值为$y$，且$dis(r,v)=h$，即第二段的权值是一个有$h$位的十进制数$y$，则第一段的权值$x$必满足同余方程$10^hx + y \equiv 0 \pmod k$

解这个同余方程等价于解二元一次不定方程$10^hx+mk=k-y$，可利用扩展欧几里得解决，无解则可直接跳过该节点。

设解出$x \equiv x_0 \mod k'$，暴力统计大概率会$T$，所以需要预处理出可能被用到的答案。

观察到$k'=\frac{k}{gcd(k,10^h)}$，即至多只有$\lfloor log_2k \rfloor$种不同的$k'$，因此对每种$k'$预处理出对应的答案即可。

最终的时间复杂度为$O(NlogNlogk)$，可能有点卡常。