# K-th Occurence

题意：给出一个字符串$S$和一些询问，查询某个子串在原串中第$k$次出现位置。

题解：涉及到子串之间的关系的大量查询不难想到后缀自动机/后缀树，这里给出一个后缀自动机的做法。

对串$S$建后缀自动机，扒出parent树。

考虑将代表第$i$个前缀$S_1S_2...S_i$的点权值设为$i$，对于后缀自动机上某个点代表的所有字符串，这些串在原串中的第$k$次出现位置（最后一个字符的下标）即为其在parent树的子树上第$k$大的权值。

在dfs序上建持久化线段树即将其转化为一个经典问题：静态区间第$k$大。

在parent树上建倍增数组即可在$O(log(n))$内找到自动机上代表某子串的点，以其为根进行子树询问即可。
